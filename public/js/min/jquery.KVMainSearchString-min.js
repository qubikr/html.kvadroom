!function($){var t='[{"title":"ЖК «Первый Московский» <em>Московский</em>","type":"city","wagons":[{"id":"252482","type":"city","data":{"title":"ЖК «Первый Московский»"}}]},{"title":"ЖК «Ново-Молоково» <em>Ленинский район</em>","type":"city","wagons":[{"id":"252461","type":"city","data":{"title":"ЖК «Ново-Молоково»"}}]},{"title":"ЖК «Град Московский» <em>Московский</em>","type":"city","wagons":[{"id":"252391","type":"city","data":{"title":"ЖК «Град Московский»"}}]},{"title":"Можайск <em>Можайский район</em>","type":"city","wagons":[{"id":"3934","type":"city","data":{"title":"Можайск"}}]},{"title":"д. Москворецкая Слобода <em>Можайский район</em>","type":"city","wagons":[{"id":"13312","type":"city","data":{"title":"д. Москворецкая Слобода"}}]},{"title":"Можайск <em>Белорусское напр.</em>","type":"railway","wagons":[{"id":"61","type":"railway","data":{"title":"Можайск","group_id":"1190"}}]},{"title":"Московский <em>Новомосковский АО</em>","type":"city","wagons":[{"id":"7170","type":"city","data":{"title":"Московский"}}]},{"title":"п. Завод Мосрентген <em>Новомосковский АО</em>","type":"city","wagons":[{"id":"12826","type":"city","data":{"title":"п. Завод Мосрентген"}}]},{"title":"с. Мокрое <em>Можайский район</em>","type":"city","wagons":[{"id":"13310","type":"city","data":{"title":"с. Мокрое"}}]},{"title":"СНТ «Московский Трубный завод» <em>Новомосковский АО</em>","type":"city","wagons":[{"id":"256650","type":"city","data":{"title":"СНТ «Московский Трубный завод»"}}]},{"title":"Можайск гп <em>Можайский район</em>","type":"city","wagons":[{"id":"10499","type":"city","data":{"title":"Можайск гп"}}]},{"title":"с. Молоково <em>Ленинский район</em>","type":"city","wagons":[{"id":"12825","type":"city","data":{"title":"с. Молоково"}}]},{"title":"д. Моденово <em>Можайский район</em>","type":"city","wagons":[{"id":"13309","type":"city","data":{"title":"д. Моденово"}}]},{"title":"д. Мордвиново <em>Можайский район</em>","type":"city","wagons":[{"id":"13311","type":"city","data":{"title":"д. Мордвиново"}}]},{"title":"д. Мотягино <em>Можайский район</em>","type":"city","wagons":[{"id":"13313","type":"city","data":{"title":"д. Мотягино"}}]},{"title":"с. Мочилы <em>Серебряно-Прудский район</em>","type":"city","wagons":[{"id":"15520","type":"city","data":{"title":"с. Мочилы"}}]},{"title":"пгт. Монино <em>Щелковский район</em>","type":"city","wagons":[{"id":"16832","type":"city","data":{"title":"пгт. Монино"}}]},{"title":"БЦ «Можайский (B)» <em>Западный АО</em>","type":"city","wagons":[{"id":"254993","type":"city","data":{"title":"БЦ «Можайский (B)»"}}]},{"title":"СНТ «Серп и Молот» <em>Домодедово</em>","type":"city","wagons":[{"id":"256708","type":"city","data":{"title":"СНТ «Серп и Молот»"}}]},{"title":"Москва Белорусская <em>Белорусское напр.</em>","type":"railway","wagons":[{"id":"11","type":"railway","data":{"title":"Москва Белорусская","group_id":"1190"}}]},{"title":"Москва Курская <em>Горьковское напр.</em>","type":"railway","wagons":[{"id":"82","type":"railway","data":{"title":"Москва Курская","group_id":"1192"}}]},{"title":"Серп и Молот <em>Горьковское напр.</em>","type":"railway","wagons":[{"id":"83","type":"railway","data":{"title":"Серп и Молот","group_id":"1192"}}]}]',e={getState:function(){return this.data("searchString").searchSelector.hasClass("active")},assume:function(){var t=this.data("searchString");t.searchSelector.hasClass("active")&&t.entryBlock.trigger("keyup")},setCurrentCity:function(t){this.data("searchString").city=t},init:function(e){function a(t,e){e=$.trim(e),e=e.replace(/[\.,\/#!$%\^&\*;:"'(){}=_`~()]/g,""),e.replace(/\s{2,}/g," ");var a=e.split(" ");a.sort(function(t,e){return e.length-t.length});for(var i=0,c=a.length;c>i;i++){var r=new RegExp(a[i],"gi");t=t.replace(r,function(t){return"<span>"+t+"</span>"})}return t}function i(t){var e=10,t=t.slice(0,e);if(l.searchSelector.html("").removeClass("active"),t&&t.length>0){var i=0;$.each(t,function(t,e){if(e&&e.title){var c=$("<li />");c.attr("data-region",l.city),e.title=a(e.title,l.entryBlock.val()),c.html(e.title).data(e).appendTo(l.searchSelector),e.type&&c.addClass(e.type),i++}}),i>0&&(l.searchSelector.find("li").eq(0).addClass("active"),l.searchSelector.addClass("active"))}}function c(){var a=l.entryBlock.val();a=a.replace(/[\.,\/#!$%\^&\*;:"'(){}=_`~()]/g,"");var c=e.dataGetter(a),r=e.url+JSON.stringify(c);a&&a.length>1&&(s[r]?i(s[r]):(s[r]=t,i(JSON.parse(t))))}var r=this;r.data("searchString",{entryBlock:$('<input class="entry main-page-search-strings" tabindex="1" placeholder="'+r.data("placeholder")+'" />'),searchSelector:$('<ul class="search-selector" />')});var l=r.data("searchString");r.append(l.entryBlock).after(l.searchSelector),l.entryBlock.css("width",r.data("width"));var n,s={};l.entryBlock.on("keydown",function(t){!$(this).val()&&$.inArray(t.keyCode,[37,38,39,40,13,8])<0&&$(this).prop("placeholder","")}),l.entryBlock.on("keyup",function(t){if(clearTimeout(n),""==$(this).val())return l.searchSelector.removeClass("active"),!1;if($.inArray(t.keyCode,[37,38,39,40,13])<0)n=setTimeout(function(){c()},200);else{t.preventDefault();var e=l.searchSelector.find("li.active");40==t.keyCode&&e.next().is("li")&&e.removeClass("active").next().addClass("active"),38==t.keyCode&&e.prev().is("li")&&e.removeClass("active").prev().addClass("active"),13==t.keyCode&&e.click()}}),$(document).on("click.searchString",function(){l.searchSelector.removeClass("active")}),l.entryBlock.on("focus",function(){r.addClass("focused")}),l.entryBlock.on("blur",function(){r.removeClass("focused")}),$(".search-string, .search-selector").on("click",function(t){t.stopPropagation(),l.entryBlock.focus(),""!=l.entryBlock.html()&&l.searchSelector.addClass("active")}),l.searchSelector.on("click.li","li",function(t){var e=$(this).data(),a=e.title.replace(/^(.*)\s<em.*$/,"$1");t.stopPropagation(),l.searchSelector.removeClass("active"),l.entryBlock.val(a)})}};$.fn.KVTestSearchString=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?($.error("Method "+t+" does not exist on jQuery.KVSearchString"),this):e.init.apply(this,arguments)}}(jQuery);