var ClickOutside=function(e){var i=this,t=_.uniqueId("UIClickOutside_");this.options=$.extend({selector:"",onClickOutside:function(e){}},e),this.bind=function(){this.unbind(),$(document).on("mouseup."+t,function(e){var t=$(i.options.selector);t.is(e.target)||0!==t.has(e.target).length||i.options.onClickOutside(e.target)})},this.unbind=function(){$(document).off("mouseup."+t)}};$(function(){$(".offers-2 .list>.item").each(function(){var e=$(this).find(".frames"),i=e.children(".frames-content").eq(0),t=e.parent();e.sly({horizontal:1,itemNav:"basic",smart:1,activateOn:"click",mouseDragging:0,touchDragging:1,releaseSwing:1,startAt:3,scrollBar:t.find(".scrollbar"),scrollBy:1,pagesBar:t.find(".pages"),activatePageOn:"click",speed:300,elasticBounds:1,easing:"easeOutExpo",dragHandle:1,dynamicHandle:1,clickBar:1,forward:t.find(".forward"),backward:t.find(".backward"),prev:t.find(".slide-left"),next:t.find(".slide-right"),prevPage:t.find(".prevPage"),nextPage:t.find(".nextPage")})}),$(".dropdown, .input-select, .input-hybrid, .expandable-selector").off("click").on("click",function(){var e=$(this);if(e.hasClass("active"))e.find("li.highlight").removeClass("highlight"),e.removeClass("active top"),$(document).off("keydown.filter3dropdown");else{var i=new ClickOutside({selector:"#"+e.attr("id"),onClickOutside:function(){e.removeClass("active"),$(document).off("keydown.filter3dropdown")}});i.bind(),e.removeClass("top");var t=e.find("li:not(.hide)").length*e.height()+e.height(),o=e.offset().top-t+e.height();ddExpandedEndPositionBottom=t+e.offset().top,console.log(o),o>$(window).scrollTop()&&$(window).height()+$(window).scrollTop()<ddExpandedEndPositionBottom&&e.addClass("top"),e.addClass("active"),e.find("li.highlight").removeClass("highlight"),e.find("li").off("mouseover").on("mouseover",function(i){e.find("li").removeClass("highlight"),e.data("keysNav",!1)}),$(document).off("keydown.filter3dropdown").on("keydown.filter3dropdown",function(i){switch(e.data("keysNav")||(e.find("li").removeClass("highlight"),e.data("keysNav",!0)),i.keyCode){case 27:e.removeClass("active top"),$(document).off("keydown.filter3dropdown");break;case 13:e.find("li.highlight").trigger("click"),e.removeClass("active top"),$(document).off("keydown.filter3dropdown");break;case 38:var t=e.find("li.highlight").prev("li");0===t.length&&(t=e.find("li:last")),e.find("li.highlight").removeClass("highlight"),t.addClass("highlight"),i.preventDefault(),i.stopPropagation();break;case 40:var t=e.find("li.highlight").next("li");0===t.length&&(t=e.find("li").eq(0)),e.find("li.highlight").removeClass("highlight"),t.addClass("highlight"),i.preventDefault(),i.stopPropagation()}}),e.find("li").off("click").on("click",function(i){e.is(".expandable-selector")?(e.parents(".selector").find("a").removeClass("active"),$(this).hasClass("active")?($(this).removeClass("active"),e.removeClass("selected")):(e.find("li").removeClass("active"),$(this).addClass("active"),e.addClass("selected"))):(e.find("li").removeClass("active"),$(this).addClass("active"),e.find(".title").is("input")?e.find(".title").val($(this).html()):e.find(".title").html($(this).html())),e.removeClass("active top"),i.stopPropagation()}),e.find(".val").off("click").on("click",function(e){e.stopPropagation()}).off("focus").on("focus",function(i){$(this).off("keydown").on("keydown",function(i){13===i.keyCode&&(e.find(".title").val($(this).val()),$(this).off("keyup focus"),e.removeClass("active top"),$(this).val(""))})}).focus(),e.find(".ok").off("click").on("click",function(i){e.removeClass("active top"),e.find(".title").val(e.find(".val").val()),i.preventDefault(),i.stopPropagation()})}}),$(".selector-types").find("a").on("click",function(e){e.preventDefault(),$(this).siblings("a").removeClass("active"),$(this).addClass("active")}),$(".selector-sort").find("a").on("click",function(e){e.preventDefault(),$(this).siblings("a").removeClass("active"),$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active"),$(this).siblings(".expandable-selector").removeClass("selected").find("ul li").removeClass("active")}),$(".prices .selector li").off("click").on("click",function(){$(".prices .selector li").removeClass("active"),$(this).addClass("active"),$(".prices .selector .title").html($(this).data("title"))}),$("aside").css({height:$("aside").parents(".container-main").outerHeight()}),$(".sticky-block").stick_in_parent({offset_top:20}),$(".sticky-block").on("click",function(e){e.preventDefault(),$("html, body").animate({scrollTop:0},600,"swing")}),$(".expand-filter-top-inline, .expand-filter-top").on("click",function(e){e.preventDefault(),$(".top-filter").show(),$(".page-title-header").hide()}),$(".top-filter .close").on("click",function(e){e.preventDefault(),$(".top-filter").hide(),$(".page-title-header").show()})});