var ZKCatalog={};ZKCatalog.Search=function(){this.init=function(){function t(t,n){i.set("items",n),i.set("query",t)}function n(n){var i="/json/search_text.json?q="+n;n&&n.length>2?e[i]?t(e[i]):$.ajax({url:i,dataType:"json",success:function(e){t(n,e)}}):t(n,{})}var e={},i=new Ractive({el:"#search-result",template:'<ul class="search-selector {{#if items.length > 0}}active{{/if}}">{{#items}}<li on-click="goUrl">{{{hl(title, query)}}}</li>{{/items}}</ul>',data:{hl:function(t,n){console.log(t,n),n=$.trim(n),n=n.replace(/[\.,\/#!$%\^&\*;:"'(){}=_`~()]/g,""),n.replace(/\s{2,}/g," ");var e=n.split(" ");e.sort(function(t,n){return n.length-t.length});for(var i=0,a=e.length;a>i;i++){var r=new RegExp(e[i],"gi");t=t.replace(r,function(t){return"<span>"+t+"</span>"})}return t},query:"",items:[]}});return i.on("goUrl",function(t){window.open(t.context.url,"_blank")}),$(".search-string-zk input.entry").on("keyup",function(){n($(this).val())}),this}},ZKCatalog.Map=function(){this.init=function(){var t=$(".map-zk-catalog").data();if(t&&t.center){var n=new GeoMap({id:"map-zk-catalog",fullScreenTrigger:"#fullscreen-trigger",zoom:5,clusterer:!0,controls:!0,center:t.center,onInit:function(t){for(var e=new n.Pin({type:"basic",avoidClusterer:!0,center:[54,37],balloonCloseButton:!0,content:"Text text text 2"}),i=0;100>i;)i++,new n.Pin({type:"basic_small",center:[_.random(540.2,560.6)/10,_.random(360.2,370.3)/10],balloonCloseButton:!0,content:"Text text text"})}});n.init()}return this}},ZKCatalog.init=function(){this.map=(new this.Map).init(),this.search=(new this.Search).init()},$(function(){ZKCatalog.init()});